
# Add verbose output for test execution
#AM_TESTS_ENVIRONMENT = VERBOSE=1

# Define the script that needs to be generated
TESTS_ENVIRONMENT = CONFIG_SH=$(abs_top_builddir)/tests/config.sh

# Specify config.sh as a generated file
EXTRA_DIST = config.sh.in
BUILT_SOURCES = config.sh
CLEANFILES = config.sh

# Custom rule to generate config.sh from config.sh.in
# (disabled - the file is generated by autoconf (see configure.ac)
#tests/config.sh: $(top_srcdir)/tests/config.sh.in
#	$(AM_V_GEN)sed -e 's,@prefix@,$(prefix),g' \
#                       -e 's,@exec_prefix@,$(exec_prefix),g' \
#                       -e 's,@bindir@,$(bindir),g' \
#                       -e 's,@datadir@,$(datadir),g' \
#                       < $(top_srcdir)/tests/config.sh.in > $@

SUBDIRS =

if EXAMPLES
SUBDIRS += examples
SUBDIRS += examples2
endif

if REGTESTS
SUBDIRS += regr
endif

if TESTS
SUBDIRS += unit
endif

EXTRA_DIST += data config_default.sh


# Pre-test validation
# (disabled: it works, but runs _after_ running tests...)
#check-local:
#	@echo "Running pre-test validation..."
#	@test -f $(abs_top_builddir)/tests/config.sh && \
#            echo "config.sh is present" || \
#            echo "ERROR: config.sh is missing!"
